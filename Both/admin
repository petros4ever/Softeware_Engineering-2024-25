from kivy.lang import Builder
from kivymd.app import MDApp
from kivymd.uix.screen import Screen
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.list import OneLineListItem
from kivymd.uix.toolbar import MDTopAppBar
from kivymd.uix.button import MDRaisedButton
from kivymd.uix.expansionpanel import MDExpansionPanel, MDExpansionPanelOneLine

KV = """
MDScreen:
    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: "Admin Dashboard"
            right_action_items: [["account", lambda x: app.show_profile()]]

        MDTextField:
            hint_text: "Search books"
            icon_right: "magnify"
            size_hint_x: 0.9
            pos_hint: {"center_x": 0.5}

        ScrollView:
            MDBoxLayout:
                id: book_list
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height

        MDRaisedButton:
            text: "Admin Panel"
            pos_hint: {"center_x": 0.5}
            on_release: app.open_admin_panel()
"""


class AdminApp(MDApp):
    def build(self):
        return Builder.load_string(KV)

    def on_start(self):
        book_data = {
            "Fiction": ["Book 1", "Book 2"],
            "Non-Fiction": ["Book 3", "Book 4"],
            "Science": ["Book 5", "Book 6"],
            "History": ["Book 7", "Book 8"],
            "Technology": ["AI Revolution", "Cyber Security 101", "Python for AI"]
        }

        for category, books in book_data.items():
            panel_content = MDBoxLayout(orientation='vertical', adaptive_height=True)
            for book in books:
                panel_content.add_widget(OneLineListItem(text=book))

            self.root.ids.book_list.add_widget(
                MDExpansionPanel(
                    content=panel_content,
                    panel_cls=MDExpansionPanelOneLine(text=category)
                )
            )

    def show_profile(self):
        print("Opening Profile Page")

    def open_admin_panel(self):
        print("Navigating to Admin Panel")


AdminApp().run()

